<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Chatww</title>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>
  </head>
  <body>
    <header>
      <h1>Welcome to Chat With World</h1>
      <div id="userName">Connecting...</div>
      <div id="msgTopBar"></div>
    </header>
    
    <nav>
      <ul class="nav">
        <li><a id="li1"href="index.html">Public</a></li>
        <li><a id="li2"href="rooms.html">Rooms</a></li>
      </ul>
    </nav>
    
    <div id="messages"></div>
    
    <div id="pic">
        <style>
          #notyet{
            color:white;
            padding:100px;
          }
        </style>
    </div>
    
    
    
   <!-- <div id="sendBox">
      <input id="messageInput" placeholder="Type a message"/>
      <button onclick="sendMessage()">Send</button>
      <button onclick="clearChat()">Clear Chat</button>
    </div> -->
    
    <script>
    const firebaseConfig = {
      apiKey: "AIzaSyDZMYWXxl-W6tKJvGF7aRrq8hcpg4TdE9I",
      authDomain: "chatwleo.firebaseapp.com",
      databaseURL: "https://chatwleo-default-rtdb.firebaseio.com",
      projectId: "chatwleo",
      storageBucket: "chatwleo.firebasestorage.app",
      messagingSenderId: "616988584387",
      appId: "1:616988584387:web:81b829019252d78cdd7576"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
  
    const guestName = "Guest_" + Math.floor(Math.random() * 10000);
    document.getElementById("userName").innerText = "You are " + guestName;

    db.ref("globalChat").limitToLast(100).on("child_added", snapshot => {
      const msg = snapshot.val();
      const div = document.createElement("div");
      div.className = "msg";

      const nameSpan = document.createElement("span");
      nameSpan.className = "name";
      nameSpan.textContent = msg.user + ": ";

      const textNode = document.createTextNode(msg.text);

      div.appendChild(nameSpan);
      div.appendChild(textNode);

      document.getElementById("messages").appendChild(div);
      document.getElementById("messages").scrollTop =
      document.getElementById("messages").scrollHeight;
    });
    
    function sendMessage() {
      const input = document.getElementById("messageInput");
      const text = input.value.trim();
      if (!text) return;

      db.ref("globalChat").push({
        user: guestName,
        text: text,
        time: Date.now()
      });

      input.value = "";
    }  

    document.getElementById("messageInput").addEventListener("keydown", e => {
      if (e.key === "Enter") sendMessage();
    });

    function clearChat() {
      if (!confirm("Clear all messages?")) return;
      db.ref("globalChat").remove();
      document.getElementById("messages").innerHTML = "";
    }
    db.ref("globalChat").on("value", snapshot => {
      if (!snapshot.exists()) {
      document.getElementById("messages").innerHTML = "";
       }
    });

    </script>
    
    <style>
      body{
        font-family: Arial,sans-serif;
        background: #0f172a;
        color: white;
        display: flex;
        flex-direction: column;
        height: 100vh; 
        margin: 0 auto;
      }
      header{
        padding: 10px;
        background: #020617;
        text-align: left;
        height:5em;
      }
      header h1{
      font-size: 1.5rem;
      }
      #messages {
        flex:1;
        padding: 5px;
        overflow-y: auto;
        font-family:sans-serif;
      }
      .msg{
        word-wrap: break-word; 
        overflow-wrap: anywhere;
        background: rgba(255, 255, 255, 0.05); 
        padding: 8px; 
        border-radius: 8px; 
        margin-bottom: 8px;
      }
      .name{
        font-weight: bold;
        color: #38bdf8;
      }
      #sendBox{
        display: flex;
        padding: 5px;
        gap: 4px;
        border-radius:15px;
        border: 2px solid #22c55e;
        margin:10px;
      }
      input{
        flex: 1;
        padding: 8px;
        border-radius:10px;
        border:none;
        outline:none;
        background: #020617;
        color: white;
      }
      button{
        padding: 8px 12px;
        cursor: pointer;
        border-radius:90px;
        background: #22c55e;
        border:none;
      }
      #msgTopBar {
        display: flex;
        justify-content: flex-end;
        padding: 8px 10px;
      }
      #li2{
        color:#22c55e;
      }
      nav{
        width: 100%;
        background: #020617;
        position: sticky;
        top: 0;
        z-index: 20;
        border-bottom: 1px solid rgba(255,255,255,0.08);
      }

      .nav {
        display: flex;
        margin: 0;
        padding: 0;
      }

      .nav li {
        list-style: none;
        flex: 1;
      }

      .nav li a {
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 12px 0;
        text-decoration: none;
        color: white;
        font-weight: 700;
        letter-spacing: 0.5px;
        transition: 0.25s ease;
      }

      .nav li a:hover {
        background: rgba(56,189,248,0.18);
      }

      .nav li a.active {
       border-radius: 12px;
       margin: 6px;
       box-shadow: 0 0 10px rgba(56,189,248,0.5);
      }
      @media (max-width: 600px) {
        header{
          height:4em;
        }
        header h1 {
          font-size: 1.2rem;
        }
        #messages {
          padding: 6px;
        }
        #sendBox {
          padding: 6px;
          gap: 4px;
          position: sticky;
          bottom: 0;
        }
        input {
          padding: 6px;
          background: #020617;
          color: white;
        }
        button {
         padding: 4px 10px;
         font-size:0.8rem;
        }
      }

    </style>
</body>
</html>
